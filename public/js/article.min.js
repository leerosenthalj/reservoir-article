var waterBuckets=!1;$(document).ready(function(){adjustViewport();var a=$(".title").outerHeight();$(".title").css({height:a}),$(".mini-title").css({height:.8*a}),$(".lazy").Lazy(),drawMaps(),loadHistoricalData(),makePDSIGraphic("PDSI-viz"),makeHistoricalReservoirViz(),makeReservoirFillGraphic(),createMontagueViz(),makePDSISlider("dependency-slider-viz","dependency-label","PDSI","dependency-slider",3,!0,"pdsi-indicator"),makeFillGaugeForPDSISlider(),makeMultipleFillGauge(),$(window).scroll(handleScrolling)}),$(window).resize(function(){resizeColorCodeDivs(),adjustViewport()});function adjustViewport(){var a=$("window").outerHeight();$(".title").css({height:a}),$(".mini-title").css({height:.67*a})}function handleScrolling(){scrollMontague(),scrollBuchanan(),scrollStats()}var state="abs";function scrollMontague(){var a=$(window).scrollTop(),b=$("#slide1-graphic").position().top,c=$("#slide-1-2").position().top,d=$("#slide-1-3").position().top,e=$("#slide-1-4").position().top,f=$("#slide-1-5").position().top,g=$("#montague-div").position().top+b-0.4*$(window).height(),h=$("#montague-div").position().top+$("#montague-div").outerHeight(!0)-$(window).height(),i="50%",j="25%";800>=$(window).width()&&(i="80%",j="10%"),$("#buckets-wrapper").css({height:.4*$(window).height(),paddingBottom:.2*$(window).height()}),a<=g&&"absb"!=state?($("#slide1-graphic").css({position:"absolute",top:.4*$(window).height(),bottom:"auto",width:i,left:j}),state="abs"):a<h?(console.log(i),$("#slide1-graphic").css({position:"fixed",top:.4*$(window).height(),bottom:"auto",width:i,left:j}),state="fixed"):"abs"!=state&&($("#slide1-graphic").css({position:"absolute",bottom:0,top:"auto",width:i,left:j}),state="absb");var m=a-$("#montague-div").position().top+0.2*$(window).height();f<m?updateWaterBuckets(16,25,10,20):e<m?updateWaterBuckets(240,25,10,20):e<m?updateWaterBuckets(800,25,10,20):d<m?updateWaterBuckets(800,25,10,20):c<m?updateWaterBuckets(2200,25,10,20):updateWaterBuckets(5e3,25,10,10)}function scrollBuchanan(){var a=$(window).scrollTop(),b=$("#seasonality-scrolly").position().top,c=$("#buch-2").position().top,d=$("#seasonality-scrolly").position().top+$("#seasonality-scrolly").outerHeight(!0)-$(window).height(),e="50%",f="25%";500>=$(window).width()?(e="80%",f="10%"):800>=$(window).width()&&(e="65%",f="17.5%"),a<b?$("#seasonality-graphic").css({position:"absolute",top:.4*$(window).height(),bottom:"auto",width:e,left:f}):a<d?$("#seasonality-graphic").css({position:"fixed",top:.4*$(window).height(),bottom:"auto",width:e,left:f}):$("#seasonality-graphic").css({position:"absolute",bottom:0,top:"auto",width:e,left:f});var g=a-b+0.2*$(window).height();c<g?advanceBuchananChart():rewindBuchananChart()}function scrollStats(){var a=$(window).scrollTop(),b=$("#statistical-scrolly").position().top,c=$("#stat-2").position().top,d=$("#stat-3").position().top,e=$("#statistical-scrolly").position().top+$("#statistical-scrolly").outerHeight(!0)-$(window).height();a<b?($("#connected-res-viz").removeClass("fixed"),$("#connected-res-viz").removeClass("absolute-bottom"),$("#connected-res-viz").addClass("absolute")):a<e?($("#connected-res-viz").removeClass("absolute"),$("#connected-res-viz").removeClass("absolute-bottom"),$("#connected-res-viz").addClass("fixed")):($("#connected-res-viz").removeClass("fixed"),$("#connected-res-viz").removeClass("absolute"),$("#connected-res-viz").addClass("absolute-bottom"));var f=a-b+0.2*$(window).height();d<f?clusterRed():c<f?oneResRed():noResRed()}function hideSlides(){$("#slide-1").css("opacity",0),$("#slide-1-2").css("opacity",0),$("#slide-1-3").css("opacity",0),$("#slide-1-4").css("opacity",0),$("#slide-1-5").css("opacity",0)}function showSlide(a){$("#slide-"+a).css("opacity",1)}function createMontagueViz(){waterBuckets||(waterBuckets=!0,makeWaterBuckets("#buckets-wrapper",25,10,20,600,300,50))}function makeHistoricalReservoirViz(){var a=$("<svg id='vizContainer' viewBox='0 0 600 450'></svg>"),b=$("<svg id='gauges' viewBox='0 0 300 375' x='300' y='0' width='300'></svg>"),c=$("<svg id='map' class='map' x='0' y='0' width='300'></svg>"),d=$("<div id='slider'></div>"),e=$("<div id='slider-inner-div'></div>"),f=$("<div id='click-here-div'></div>");f.append($("<p>Drag slider</p>")),f.append($("<img src='down_arrow.png' height='100%' class='lazy'>")),e.css("position","relative"),d.append(e);var g=$("<p id='start-label'>2003</p>"),h=$("<p id='end-label'>2016</p>");d.append(g),d.append(h),$("#reservoirs-matter-viz").append(a),a.append(c),a.append(b),$("#reservoirs-matter-viz").append(d),d.append(f)}function oneResRed(){$("#INV-stat")&&(d3.select("#ORO-stat").transition().duration(200).style("fill","rgb(255, 255, 255)"),d3.select("#FOL-stat").transition().duration(200).style("fill","rgb(255, 255, 255)"),d3.select("#SHA-stat").transition().duration(200).style("fill","rgb(255, 255, 255)"),d3.select("#INV-stat").transition().duration(200).style("fill","rgb(255, 0, 0)"),d3.select("#INV-ORO").transition().duration(200).style("stroke","white"),d3.select("#INV-FOL").transition().duration(200).style("stroke","white"),d3.select("#SHA-INV").transition().duration(200).style("stroke","white"),d3.select("#SHA-ORO").transition().duration(200).style("stroke","white"))}function clusterRed(){$("#ORO-INV")&&$("#INV-FOL")&&$("#SHA-INV")&&($("#INV-stat").attr("style","fill: red;"),d3.select("#ORO-stat").transition().duration(200).style("fill","rgb(255, 0, 0)"),d3.select("#FOL-stat").transition().duration(200).style("fill","rgb(255, 0, 0)"),d3.select("#SHA-stat").transition().duration(200).style("fill","rgb(255, 0, 0)"),d3.select("#INV-ORO").transition().duration(200).style("stroke","rgb(255, 0, 0)"),d3.select("#INV-FOL").transition().duration(200).style("stroke","rgb(255, 0, 0)"),d3.select("#SHA-INV").transition().duration(200).style("stroke","rgb(255, 0, 0)"),d3.select("#SHA-ORO").transition().duration(200).style("stroke","rgb(255, 0, 0)"))}function noResRed(){$("#INV-ORO")&&$("#INV-FOL")&&$("#SHA-INV")&&(d3.select("#ORO-stat").transition().duration(200).style("fill","rgb(255, 255, 255)"),d3.select("#FOL-stat").transition().duration(200).style("fill","rgb(255, 255, 255)"),d3.select("#SHA-stat").transition().duration(200).style("fill","rgb(255, 255, 255)"),d3.select("#INV-stat").transition().duration(200).style("fill","rgb(255, 255, 255)"),d3.select("#INV-ORO").transition().duration(200).style("stroke","rgb(255, 255, 255)"),d3.select("#INV-FOL").transition().duration(200).style("stroke","rgb(255, 255, 255)"),d3.select("#SHA-INV").transition().duration(200).style("stroke","rgb(255, 255, 255)"),d3.select("#SHA-ORO").transition().duration(200).style("stroke","rgb(255, 255, 255)"))}